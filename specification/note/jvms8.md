>参考：[JVM规范系列@陈树义](https://www.cnblogs.com/chanshuyi/p/jvm_specification_00_guide.html)

[TOC]

## 1.引言

### 历史
- Java编程语言是一种通用的、并发的、面向对象的语言。（**并发**、**面向对象**）
- Java平台最初是为了解决为联网的消费者设备构建软件的问题而开发的。它被设计来支持多主机架构，并允许软件组件的安全交付。（**跨平台**，**安全**）
- HotJava浏览器首先展示了java编程语言和平台的有趣特性，它使在HTML页面中嵌入程序成为可能。（**动态Web**）
- 程序员只需编写一次程序，就可以在任何提供Java运行时环境的机器上运行。

### JVM
- JVM是Java平台的基石。是实现硬件、操作系统的独立性，编译代码的小体积，以及保护用户免受恶意程序攻击的能力的关键部分。
- JVM是一种抽象的计算机器。它有自己的指令集以及各种运行时内存区域。
- JVM对Java编程语言一无所知，只知道一种特定的二进制格式，即class文件格式（包含JVM指令(或字节码)和一个符号表，以及其他辅助信息）。

### 提要
- 第二章提供了JVM结构的概述。（**理解**）
- 第三章介绍了用Java编程语言编写的代码到JVM指令集的编译过程。（**了解**）
- 第四章特别介绍class文件格式，这是一种与硬件和操作系统无关的二进制格式，用于表示已编译的类和接口。（**了解**）
- 第五章介绍了JVM的启动以及类和接口的加载、链接和初始化。（**掌握**）
- 第六章介绍了JVM指令集。（**可略过**）

## 2.JVM结构
- JVM规范是一种高度抽象行为的描述，而不是具体虚拟机的实现。
- 要正确地实现JVM，您只需能够读取类文件格式并正确地执行其中指定的操作。

### class文件格式
- 由JVM执行的已编译代码使用与硬件和操作系统无关的二进制格式表示，通常(但不一定)存储在文件中，称为class文件格式。
- class文件格式精确地定义了类或接口的表示形式。

### 数据类型
- 与Java编程语言一样，JVM操作两种数据类型：基本类型和引用类型。
- 两种类型的值可以存储在变量中，作为参数传递，通过方法返回，对其进行操作。
- JVM期望几乎所有类型检查都在运行时之前完成，通常由编译器完成。
- JVM包含对对象的显式支持。对象要么是动态分配的类实例，要么是数组。
- 引用类型的值视为指向对象的指针。一个对象可能存在多个引用。对象总是通过引用类型的值进行操作、传递和测试。

### 基本类型
- JVM支持的原始类型有：numeric类型、boolean类型、returnAddress类型。
- numeric类型包含integral类型和floating-point类型。
- integral类型：byte(8b)、short(18b)、int(32b)、long(64b)、char(16b)。
- floating-point类型：float(32b)、double(64b)。
- boolean类型：值为true或false。
- returnAddress类型：指向JVM指令的操作码的指针。

### 引用类型
- 三种引用类型：class类型，数组类型，接口类型。
- 它们的值分别是对动态创建的类实例、数组或实现接口的类实例或数组的引用。

### 运行时数据区域 
- JVM创建的数据区域
    - 堆（存储类实例和数组，被GC回收，会抛OutOfMemoryError）
    - 方法区（存储类结构信息：运行时常量池、字段和方法数据，以及方法和构造函数的代码，会抛OutOfMemoryError）
    - 运行时常量池（会抛OutOfMemoryError）
- 每个线程的数据区域
    - pc寄存器
    - JVM栈 (会抛StackOverflowError、OutOfMemoryError)
    - 本地方法栈

![](../img/jmm.png)  

### 栈帧
- 栈帧是用来存储数据和部分过程结果的数据结构，同时也被用来处理动态链接、方法返回值和异常分派。
- 栈帧随着方法调用而创建，随着方法结束而销毁——无论方法是正常完成还是异常完成（抛出了在方法内未被捕获的异常）都算作方法结束。
- 栈帧的存储空间分配在JVM之中，每一个栈帧都有自己的局部变量表、操作数栈和指向当前方法所属的类的运行时常量池的引用。
### 浮点运算
## 3.JVM编译
## 4.class文件格式
## 5.加载、连接、初始化
### 运行时常量池
### JVM启动
### 类的创建和加载
### 类的连接
### 类的初始化
### 绑定本地方法实现
### JVM退出
## 6.JVM指令集